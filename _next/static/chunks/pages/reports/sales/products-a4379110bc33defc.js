(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[990],{35239:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports/sales/products",function(){return t(98322)}])},47685:function(e,a,t){"use strict";t.d(a,{w:function(){return d}});var s=t(47568),r=t(26042),n=t(69396),o=t(34051),l=t.n(o),c=t(17563),i=t(32809),m=t(47715),d=function(){var e=(0,s.Z)(l().mark((function e(a,t){var s,o,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,c.stringifyUrl)({url:a,query:(0,n.Z)((0,r.Z)({},t),{csv:!0})}),e.next=3,m.o.get(s,{responseType:"blob"});case 3:o=e.sent,d=o.headers["content-disposition"].split("filename=")[1],(0,i.S)(o.data,d);case 6:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}()},64534:function(e,a,t){"use strict";t.d(a,{k:function(){return n}});var s=t(85893),r=t(10638),n=function(e){var a=e.className,t=e.children;return(0,s.jsxs)("div",{className:"text-sm bg-background dark:bg-background-dark md:grid print:flex print:bg-white relative",id:"main",children:[(0,s.jsx)(r.v2,{}),(0,s.jsx)("main",{"data-scroll":"scroll",className:"p-2 md:p-4 lg:p-8 md:px-12 space-y-4 h-screen overflow-y-auto print:overflow-y-hidden overflow-x-visible print:h-auto print:p-0 print:space-y-0 ".concat(a),children:t})]})}},98322:function(e,a,t){"use strict";t.r(a);var s=t(47568),r=t(26042),n=t(99534),o=t(828),l=t(29815),c=t(34051),i=t.n(c),m=t(85893),d=t(32912),p=t(67294),u=t(4374),f=t(77358),h=t(47685),w=t(10638),x=t(70011),v=t(76166),N=t(64534),g=t(50856),k=t(2428),C=t(11860);a.default=function(){var e,a,t=(0,u.$)().t,c=(0,o.Z)((0,k.dd)(),2),_=c[0],j=c[1],b="sales-report-products",y="api/reports/sales-report-products/",Z=[{name:t("product"),field:"product_name",cellClassName:"whitespace-nowrap overflow-hidden flex-1 sm:w-6/12  sm:min-w-[14rem]",columnClassName:"whitespace-nowrap"},{name:t("categories.titles"),field:"category_name",cellClassName:"whitespace-nowrap sm:w-2/12  sm:min-w-[10rem]",columnClassName:"whitespace-nowrap"},{name:t("location"),field:"location_name",cellClassName:"whitespace-nowrap sm:w-2/12  sm:min-w-[10rem]",columnClassName:"whitespace-nowrap"},{name:t("products.quantity"),field:"quantity",cellClassName:"whitespace-nowrap sm:w-1/12  sm:min-w-[10rem] sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("total"),field:"total",format:g.Lx,cellClassName:"whitespace-nowrap sm:w-1/12 sm:min-w-[10rem] sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("products.salePriceWithout"),field:"sale_price_without_vat",format:g.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("products.salePrice"),field:"sale_price",format:g.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("products.discountPercent"),field:"discount_percent",cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("products.discountValue"),field:"discount_value",format:g.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("subtotal"),field:"subtotal",format:g.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("products.vatRate"),field:"vat_rate",cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:t("tvaSum"),field:"vat_sum",format:g.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"}],P=new Date;P.setDate(1);var L=new Date(P);P.setMonth(P.getMonth()+1),P.setDate(0);var D=new Date(P),M=(0,k.M_)({date_from:(0,d.default)(L,"yyyy-MM-dd"),date_to:(0,d.default)(D,"yyyy-MM-dd")},b),E=M.options,F=M.setOptions,S=(0,p.useCallback)((function(e){F((function(a){return(0,r.Z)({},a,e)})),j.hide()}),[]),z=(0,k.NS)(y,E),I=z.data,q=z.error,O=(0,n.Z)(z,["data","error"]);(0,p.useEffect)((function(){var e=null===q||void 0===q?void 0:q.message;e&&g.mv.error(t("err.".concat(e)))}),[q]);var R=null===I||void 0===I||null===(e=I.pages)||void 0===e?void 0:e.reduce((function(e,a){return(0,l.Z)(e).concat((0,l.Z)(a))}),[]),T=null===I||void 0===I||null===(a=I.pageParams)||void 0===a?void 0:a.totals,U=(0,p.useState)(!1),X=U[0],A=U[1],V=(0,p.useCallback)((0,s.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=11;break}return A(!0),e.prev=2,e.next=5,(0,h.w)(y,E);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:A(!1);case 11:case"end":return e.stop()}}),e,null,[[2,7]])}))),[y,E,X]);return(0,m.jsxs)(N.k,{className:"flex flex-col",children:[(0,m.jsxs)(w.Ax,{links:[{name:t("categories.reportProducts"),href:"/reports/sales/products"},{name:t("categories.saleReport"),href:"/reports/sales/categories"},{name:t("categories.reportLoc"),href:"/reports/sales/locations"},{name:t("categories.reportCustomers"),href:"/reports/sales/customers"},{name:t("products.locStocks"),href:"/reports/stocks"},{name:t("cashRegister"),href:"/reports/cash-register"}],activeLink:"/reports/sales/products",name:t("categories.reportProducts"),children:[(0,m.jsx)(w.zx,{className:"button secondary dark:border-font-dark-variant dark:text-font-dark",onClick:V,children:(0,m.jsx)("i",{className:X?"fas fa-spinner animate-spin":"fas fa-download cursor-pointer"})}),(0,m.jsx)(w.zx,{className:"button secondary dark:border-font-dark-variant dark:text-font-dark",onClick:function(){return j.show()},children:(0,m.jsx)("i",{className:"fa-solid fa-sliders"})}),(0,m.jsx)(v.Z,{show:_,modal:j,children:(0,m.jsx)(w.kI,{onFilters:S,children:function(e){var a=e.handleFilter,s=e.applyFilters;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"flex flex-col gap-10",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-sm text-white",children:t("filter")}),(0,m.jsx)("h3",{className:"title mt-2 text-white",children:t("categories.reportProducts")})]}),(0,m.jsxs)("div",{className:"flex flex-col pt-4 h-[60vh] overflow-y-auto gap-10",children:[(0,m.jsx)(x.fU,{classes:"text-white",prefix:b,label:t("from"),id:"date_from",onNewDate:a,value:E.date_from}),(0,m.jsx)(x.fU,{classes:"text-white",prefix:b,label:t("to"),id:"date_to",onNewDate:a,value:E.date_to}),(0,m.jsxs)("div",{className:"grid grid-flow-row gap-8",children:[(0,m.jsx)("h3",{className:"text-xl font-medium mt-2",children:t("search_by")}),Z.map((function(e,t){return(0,m.jsx)("div",{children:(0,m.jsx)("div",{className:"flex flex-col text-left",children:(0,m.jsx)(f.II,{classes:"text-white",label:e.name,name:e.field,value:C.session.get("".concat(b,"--").concat(e.name)),onChange:function(t){C.session.set("".concat(b,"--").concat(e.name),t.target.value),a(t.target.name,t.target.value)}})})},"header-".concat(t))}))]})]})]}),(0,m.jsx)("div",{children:(0,m.jsx)(w.zx,{onClick:s,className:"filter-btn",children:t("applyFilters")})})]})}})})]}),0===(null===R||void 0===R?void 0:R.length)?(0,m.jsx)(w.X6,{}):(0,m.jsx)(w.zI,(0,r.Z)({columns:Z,data:R,totals:T,keyFunction:function(e){return e.guid+e.location_guid+e.sale_price},breakPoint:6},O))]})}}},function(e){e.O(0,[9774,2888,179],(function(){return a=35239,e(e.s=a);var a}));var a=e.O();_N_E=a}]);