(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2222],{14245:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports/sales/customers",function(){return s(20896)}])},47685:function(e,t,s){"use strict";s.d(t,{w:function(){return u}});var a=s(47568),r=s(26042),n=s(69396),o=s(34051),l=s.n(o),c=s(17563),i=s(32809),d=s(47715),u=function(){var e=(0,a.Z)(l().mark((function e(t,s){var a,o,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,c.stringifyUrl)({url:t,query:(0,n.Z)((0,r.Z)({},s),{csv:!0})}),e.next=3,d.o.get(a,{responseType:"blob"});case 3:o=e.sent,u=o.headers["content-disposition"].split("filename=")[1],(0,i.S)(o.data,u);case 6:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}()},64534:function(e,t,s){"use strict";s.d(t,{k:function(){return n}});var a=s(85893),r=s(97991),n=function(e){var t=e.className,s=e.children;return(0,a.jsxs)("div",{className:"text-sm bg-background dark:bg-background-dark md:grid print:flex print:bg-white relative",id:"main",children:[(0,a.jsx)(r.v2,{}),(0,a.jsx)("main",{"data-scroll":"scroll",className:"p-2 md:p-4 lg:p-8 md:px-12 space-y-4 h-screen overflow-y-auto print:overflow-y-hidden overflow-x-visible print:h-auto print:p-0 print:space-y-0 ".concat(t),children:s})]})}},20896:function(e,t,s){"use strict";s.r(t);var a=s(47568),r=s(26042),n=s(99534),o=s(828),l=s(29815),c=s(34051),i=s.n(c),d=s(85893),u=s(32912),m=s(67294),p=s(4374),f=s(47685),h=s(97991),x=s(77358),w=s(47402),v=s(76166),N=s(64534),g=s(88379),k=s(2428),j=s(11860);t.default=function(){var e,t,s=(0,p.$)().t,c=(0,o.Z)((0,k.dd)(),2),b=c[0],y=c[1],_=[{name:s("partners.customer"),field:"partner_name",cellClassName:"whitespace-nowrap flex-1 sm:min-w-[18rem]",columnClassName:"whitespace-nowrap"},{name:s("products.quantity"),field:"quantity",format:g.Lx,cellClassName:"whitespace-nowrap sm:w-36",columnClassName:"whitespace-nowrap"},{name:s("subtotal"),field:"subtotal",format:g.Lx,cellClassName:"whitespace-nowrap sm:w-36",columnClassName:"whitespace-nowrap"},{name:s("tvaSum"),field:"vat_sum",format:g.Lx,cellClassName:"whitespace-nowrap sm:w-36",columnClassName:"whitespace-nowrap"},{name:s("total"),field:"total",format:g.Lx,cellClassName:"whitespace-nowrap sm:w-36",columnClassName:"whitespace-nowrap"}],C=new Date;C.setDate(1),C.setHours(0,0);var Z=new Date(C);C.setMonth(C.getMonth()+1),C.setDate(0),C.setHours(23,59);var D=new Date(C),M="sales-report-customers",S="api/reports/sales-report-customers/",E=(0,k.M_)({date_from:(0,u.default)(Z,"yyyy-MM-dd HH:mm"),date_to:(0,u.default)(D,"yyyy-MM-dd HH:mm")},M),F=E.options,H=E.setOptions,L=(0,k.NS)(S,F),T=L.data,q=L.error,z=(0,n.Z)(L,["data","error"]);(0,m.useEffect)((function(){var e=null===q||void 0===q?void 0:q.message;e&&g.mv.error(s("err.".concat(e)))}),[q]);var I=null===T||void 0===T||null===(e=T.pages)||void 0===e?void 0:e.reduce((function(e,t){return(0,l.Z)(e).concat((0,l.Z)(t))}),[]),O=null===T||void 0===T||null===(t=T.pageParams)||void 0===t?void 0:t.totals,P=(0,m.useCallback)((function(e){H((function(t){return(0,r.Z)({},t,e)})),y.hide()}),[]),U=(0,m.useState)(!1),X=U[0],R=U[1],A=(0,m.useCallback)((0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=11;break}return R(!0),e.prev=2,e.next=5,(0,f.w)(S,F);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:R(!1);case 11:case"end":return e.stop()}}),e,null,[[2,7]])}))),[S,F,X]);return(0,d.jsxs)(N.k,{className:"flex flex-col",children:[(0,d.jsxs)(h.Ax,{links:[{name:s("categories.reportProducts"),href:"/reports/sales/products"},{name:s("categories.saleReport"),href:"/reports/sales/categories"},{name:s("categories.reportLoc"),href:"/reports/sales/locations"},{name:s("categories.reportCustomers"),href:"/reports/sales/customers"},{name:s("products.locStocks"),href:"/reports/stocks"},{name:s("cashRegister"),href:"/reports/cash-register"}],activeLink:"/reports/sales/customers",name:s("categories.reportCustomers"),children:[(0,d.jsx)(h.zx,{className:"button secondary dark:border-font-dark-variant dark:text-font-dark",onClick:A,children:(0,d.jsx)("i",{className:X?"fas fa-spinner animate-spin":"fas fa-download cursor-pointer"})}),(0,d.jsx)(h.zx,{className:"button secondary dark:border-font-dark-variant dark:text-font-dark",onClick:function(){return y.show()},children:(0,d.jsx)("i",{className:"fa-solid fa-sliders"})}),(0,d.jsx)(v.Z,{show:b,modal:y,children:(0,d.jsx)(h.kI,{onFilters:P,children:function(e){var t=e.handleFilter,a=e.applyFilters;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex flex-col gap-10",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm text-white",children:s("filter")}),(0,d.jsx)("h3",{className:"title mt-2 text-white",children:s("categories.reportCustomers")})]}),(0,d.jsx)(w.fU,{prefix:M,label:s("from"),id:"date_from",onNewDate:t,value:F.date_from,classes:"text-white",showTimeSelect:!0}),(0,d.jsx)(w.fU,{prefix:M,label:s("to"),id:"date_to",onNewDate:t,value:F.date_to,classes:"text-white",showTimeSelect:!0}),(0,d.jsx)(w.bd,{id:M,setOptions:t,label:s("users")}),(0,d.jsx)("div",{className:"space-y-4 pt-4 h-[60vh] overflow-y-auto",children:(0,d.jsxs)("div",{className:"grid grid-flow-row gap-8",children:[(0,d.jsx)("h3",{className:"text-xl font-medium mt-2",children:s("search_by")}),_.map((function(e,s){return(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"flex flex-col text-left",children:(0,d.jsx)(x.II,{classes:"text-white",label:e.name,name:e.field,value:j.session.get("".concat(M,"--").concat(e.name))||"",onChange:function(s){j.session.set("".concat(M,"--").concat(e.name),s.target.value),t(s.target.name,s.target.value)}})})},"header-".concat(s))}))]})})]}),(0,d.jsx)("div",{children:(0,d.jsx)(h.zx,{onClick:a,className:"filter-btn",children:s("applyFilters")})})," "]})}})})]}),0===(null===I||void 0===I?void 0:I.length)?(0,d.jsx)(h.X6,{}):(0,d.jsx)(h.zI,(0,r.Z)({columns:_,data:I,totals:O,keyFunction:function(e){return e.quantity+e.subtotal+e.total+e.vat_sum}},z))]})}}},function(e){e.O(0,[9774,2888,179],(function(){return t=14245,e(e.s=t);var t}));var t=e.O();_N_E=t}]);