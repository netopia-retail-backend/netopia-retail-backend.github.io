(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[990],{35239:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports/sales/products",function(){return a(98322)}])},47685:function(e,t,a){"use strict";a.d(t,{w:function(){return m}});var s=a(47568),r=a(26042),n=a(69396),o=a(34051),l=a.n(o),c=a(17563),i=a(32809),p=a(47715),m=function(){var e=(0,s.Z)(l().mark((function e(t,a){var s,o,m;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,c.stringifyUrl)({url:t,query:(0,n.Z)((0,r.Z)({},a),{csv:!0})}),e.next=3,p.o.get(s,{responseType:"blob"});case 3:o=e.sent,m=o.headers["content-disposition"].split("filename=")[1],(0,i.S)(o.data,m);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},64534:function(e,t,a){"use strict";a.d(t,{k:function(){return n}});var s=a(85893),r=a(37566),n=function(e){var t=e.className,a=e.children;return(0,s.jsxs)("div",{className:"text-sm bg-background dark:bg-background-dark md:grid print:flex print:bg-white relative",id:"main",children:[(0,s.jsx)(r.v2,{}),(0,s.jsx)("main",{"data-scroll":"scroll",className:"p-2 md:p-4 lg:p-8 md:px-12 space-y-4 h-screen overflow-y-auto print:overflow-y-hidden overflow-x-visible print:h-auto print:p-0 print:space-y-0 ".concat(t),children:a})]})}},98322:function(e,t,a){"use strict";a.r(t);var s=a(47568),r=a(26042),n=a(99534),o=a(29815),l=a(34051),c=a.n(l),i=a(85893),p=a(32912),m=a(67294),u=a(4374),d=a(47685),f=a(37566),w=a(64534),h=a(88379),x=a(2428);t.default=function(){var e,t,a=(0,u.$)().t,l="sales-report-products",v="api/reports/sales-report-products/",N=[{name:a("product"),field:"product_name",cellClassName:"whitespace-nowrap overflow-hidden flex-1 sm:w-6/12  sm:min-w-[14rem]",columnClassName:"whitespace-nowrap"},{name:a("categories.pluralTitle"),field:"category_name",cellClassName:"whitespace-nowrap sm:w-2/12  sm:min-w-[10rem]",columnClassName:"whitespace-nowrap"},{name:a("location"),field:"location_name",cellClassName:"whitespace-nowrap sm:w-2/12  sm:min-w-[10rem]",columnClassName:"whitespace-nowrap"},{name:a("products.quantity"),field:"quantity",cellClassName:"whitespace-nowrap sm:w-1/12  sm:min-w-[10rem] sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("products.total"),field:"total",format:h.Lx,cellClassName:"whitespace-nowrap sm:w-1/12 sm:min-w-[10rem] sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("products.salePriceWithout"),field:"sale_price_without_vat",format:h.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("products.salePrice"),field:"sale_price",format:h.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("products.discountPercent"),field:"discount_percent",cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("products.discountValue"),field:"discount_value",format:h.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("subtotal"),field:"subtotal",format:h.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("products.vatRate"),field:"vat_rate",cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"},{name:a("tvaSum"),field:"vat_sum",format:h.Lx,cellClassName:"whitespace-nowrap flex-1 sm:text-right",columnClassName:"whitespace-nowrap"}],g=new Date;g.setDate(1),g.setHours(0,0);var _=new Date(g);g.setMonth(g.getMonth()+1),g.setDate(0),g.setHours(23,59);var C=new Date(g),k=(0,x.M_)({from:(0,p.default)(_,"yyyy-MM-dd HH:mm"),to:(0,p.default)(C,"yyyy-MM-dd HH:mm")},l),y=k.options,b=k.setOptions,j=(0,x.NS)(v,y),Z=j.data,E=j.error,L=(0,n.Z)(j,["data","error"]);(0,m.useEffect)((function(){var e=null===E||void 0===E?void 0:E.message;e&&h.mv.error(a("err.".concat(e)))}),[E]);var M=null===Z||void 0===Z||null===(e=Z.pages)||void 0===e?void 0:e.reduce((function(e,t){return(0,o.Z)(e).concat((0,o.Z)(t))}),[]),P=null===Z||void 0===Z||null===(t=Z.pageParams)||void 0===t?void 0:t.totals,S=(0,m.useState)(!1),H=S[0],T=S[1],D=(0,m.useCallback)((0,s.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=11;break}return T(!0),e.prev=2,e.next=5,(0,d.w)(v,y);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:T(!1);case 11:case"end":return e.stop()}}),e,null,[[2,7]])}))),[v,y,H]);return(0,i.jsxs)(w.k,{className:"flex flex-col",children:[(0,i.jsxs)(f.Ax,{links:[{name:a("reports.product"),href:"/reports/sales/products"},{name:a("reports.category"),href:"/reports/sales/categories"},{name:a("reports.location"),href:"/reports/sales/locations"},{name:a("reports.customer"),href:"/reports/sales/customers"},{name:a("reports.productStocks"),href:"/reports/stocks"},{name:a("reports.cashRegister"),href:"/reports/cash-register"}],activeLink:"/reports/sales/products",name:a("reports.product"),children:[(0,i.jsx)(f.zx,{className:"button secondary dark:border-font-dark-variant dark:text-font-dark",onClick:D,children:(0,i.jsx)("i",{className:H?"fas fa-spinner animate-spin":"fas fa-download cursor-pointer"})}),(0,i.jsx)(f.wn,{setOptions:b,options:y,id:l,title:a("reports.product"),filters:(0,r.Z)({date_from:{showTimeSelect:!0},date_to:{showTimeSelect:!0},user:!0},Object.fromEntries(N.map((function(e){return[e.field,{label:e.name,key:"".concat(l,"_").concat(e.field)}]}))))})]}),0===(null===M||void 0===M?void 0:M.length)?(0,i.jsx)(f.X6,{}):(0,i.jsx)(f.zI,(0,r.Z)({columns:N,data:M,totals:P,keyFunction:function(e){return e.guid+e.location_guid+e.sale_price+e.total},breakPoint:6},L))]})}}},function(e){e.O(0,[9774,2888,179],(function(){return t=35239,e(e.s=t);var t}));var t=e.O();_N_E=t}]);